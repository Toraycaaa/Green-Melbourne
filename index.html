<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Trees in Melb</title>

    <!-- Semantic -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/semantic-ui@2.4.2/dist/semantic.min.css">
    <!--import css-->
    <link href="./trees.css" rel='stylesheet'>
    <link rel="shortcut icon" href="./tree-png.ico">
    
    <script src='https://api.mapbox.com/mapbox-gl-js/v1.12.0/mapbox-gl.js'></script>
    <link href='https://api.mapbox.com/mapbox-gl-js/v1.12.0/mapbox-gl.css' rel='stylesheet' />

</head>
<body style='background-color: #222222;'>

 <!--nav-->
 <div class="ui fixed inverted menu" id="nav">
     <div class="ui container">
         <a href="#top" class="header item" id="title">
             <img src="./img/logo.svg">&nbsp;
             City Tree Planting
         </a>

        <a class="ui right item " href="#map_location">
            Tree Map
        </a>

        <a class="item olive" href="#statistic_location">
          Statistic
        </a>

        <a class="ui item " href="#schedule_location">
            Schedule Map
        </a>


    

     </div>
 </div>







    

    
    <!--body-->
    
    <div class="ui container" >
        <!--Home-->
        <div class="ui container" style='background-image: url("./img/green-rooftop-898.png");background-position:right top;background-repeat:no-repeat;background-size:100%;'>
            <div id="top"></div>
            <br />
            <br />
            <br />
            <br />
            <br />
            <div class="ui container" style="padding-left: 20px;">
                <h1 class="title_tree">City of Melbourne - Tree Planting</h1>
                <br />
                <p style="color: #CCCCC1;">Melbourne’s tree population is vast – we have 70,000 council-owned trees,
                <p style="color: #CCCCC1;">worth around $650 million.  This website enables you to explore the current 
                <p style="color:#CCCCC1;">tree planting stutus within the city of Melbourne and some of the challenges </p>
                <p style="color:#CCCCC1;">facing Melbourne’s Urban Forest.</p>
                <br>
                <br>
                <i class="arrow inverted circle right icon"></i>&nbsp;<a href="https://data.melbourne.vic.gov.au/Environment/Trees-with-species-and-dimensions-Urban-Forest-/fp38-wiyy/data">Find out the data source</a><br>
                <i class="arrow inverted circle right icon"></i>&nbsp;<a href="https://www.melbourne.vic.gov.au/community/greening-the-city/urban-forest/Pages/urban-forest.aspx">Find out more about the Urban Forest Strategy</a><br>
                <i class="arrow inverted circle right icon"></i>&nbsp;<a href="https://data.melbourne.vic.gov.au/Environment/Tree-Planting-Schedule/jzfa-q3k3">Find out Street Tree Planting Schedule</a>
            </div>
            
            
            <!-- <div class="ui container">
                <a href="#map_location">
                    <button class="ui inverted olive basic button" >
                        <span style="color: #76AD3A;" >Explore the </span><span style='font-weight: bold;color:#76AD3A'>Tree Map</span>
                    </button>
                </a>&nbsp;&nbsp;

                <button class="ui inverted olive basic button">
                    <span style="color: #76AD3A;">Learn about the </span><span style='font-weight: bold;color:#76AD3A'>Schedule</span>
                </button>&nbsp;&nbsp;
                <button class="ui inverted olive basic button">
                    <span style="color: #76AD3A;">Learn more about </span><span style='font-weight: bold;color:#76AD3A'>Gree City</span>
                </button>&nbsp;&nbsp;
            </div> -->
            <br />
            <br />
            <br />
            <div class="ui container">
                <!-- <div><i class="arrow inverted right icon"></i><a href="https://data.melbourne.vic.gov.au/Environment/Trees-with-species-and-dimensions-Urban-Forest-/fp38-wiyy">Find out the data source </a></div>
                <div><i class="arrow inverted right icon"></i><a href="https://www.melbourne.vic.gov.au/community/greening-the-city/urban-forest/Pages/urban-forest.aspx">Find out more about the Urban Forest Strategy</a></div>
                <br />   -->              
            </div>
        </div>




        
        <!--map-->
        <div id="map_location">
            <br />
            <br />
        </div>
        <h2 class="ui olive header" >Tree map</h2>
        <hr style="border:1 dashed #987cb9" width="100%" color=#76AD3A SIZE=1>

        <h3 style="font-size:17px; color:white">Explore the tree data</h3>
        <p style="font-size:19px; color:#989898">Individual tree data for City of Melbourne trees is presented below. <b>Pan</b> and <b>Zoom</b> into different areas of Melbourne city, <b>Hover</b> on the Filter Menu to select between different filters, <b>Hover</b> on tree symbols to reveal details of the tree, and <b>Click</b> on the link of each popup windon for the specific tree information on Wiki page.</p>
        <br />
        <div class="ui container">   
            <div class="ui inverted secondary pointing menu">
              <button class="active item" id="popup">
                <!-- <i class="wrench icon"></i>&nbsp;  -->
                <a href="#menu" style="font-size: 16px;">
                  &#9776;
                Filter Menu</a>
              </button>
                <!-- <a class="active item" id="popup"> -->
                    <!-- <i class="wrench icon"></i>&nbsp; -->
                    <!-- Hover here to choose layers -->
                <!-- </a> -->
                <!-- <a class="item" id="popup">
                    Drag map, click icons for details
                </a> -->

                <div class="ui inverted fluid popup bottom left transition hidden">
                <div class="ui four column relaxed divided grid">
                    <div class="column">
                        <h4 class="ui header">Age Description</h4>
                        <div class="ui link list" id=age>                     
                            <!-- <a class="item">Viscose</a> -->
                            <a ></a>  
                        </div>
                    </div>

                    <div class="column">
                        <h4 class="ui header">Location</h4>
                        <div class="ui link list" id=location>
                            <a></a> 
                        </div>
                    </div>

                    <div class="column">
                        <h4 class="ui header">Year Planted</h4>
                        <div class="ui link list" id=year>
                        <a></a>  
                        </div>
                    </div>

                    <div class="column">
                        <h4 class="ui header">Soil Types</h4>
                        <div class="ui link list" id=soil_type>
                        <a></a>
                        </div>
                    </div>
                </div>
                </div>
            </div>

            <!--map-->    

            <div id='map' style='height: 500px;'>
            </div>

            

        
            
            

            <h2 class="ui olive header">Map colours and symbols</h2>
            <!--tabs-->

            <div class="row">
              <div class="column" style="color:white" >
                <h3 style = "text-align: center">Age Description <i class="question circle legend icon" 
                  data-title="Age Description" 
                 data-content="Based on Date planted / date of data entry."></i></h3>
                
                <div class="ui middle aligned animated list" style="padding-left: 80px;">
                  <div class="legend item"
                  data-title="New tree" 
                  data-content="A new tree is classified as any tree planted less than one year.">
                    <img class="ui avatar image" src="./img/tree_new.svg">
                    <div class="content">
                      <div class="header m-color-white">New</div>
                    </div>
                  </div>
                  <div class="legend item"
                  data-title="Juvenile tree" 
                  data-content="A juvenile tree is classified as any young tree planted within the last few years">
                    <img class="ui avatar image" src="./img/tree_juvenile.svg">
                    <div class="content">
                      <div class="header m-color-white">Juvenile</div>
                    </div>
                  </div>
                  <div class="legend item"
                  data-title="Semi-mature tree" 
                  data-content="Semi-mature trees are no longer young but are yet to reach their full potential">
                    <img class="ui avatar image" src="./img/tree_semimature.svg">
                    <div class="content">
                      <div class="header m-color-white">Semi-mature</div>
                    </div>
                  </div>
                  <div class="legend item"
                  data-title="Mature tree" 
                  data-content="
                  A mature tree has reached it’s full potential in the landscape.">
                      <img class="ui avatar image" src="./img/tree_mature.svg">
                      <div class="content">
                        <div class="header m-color-white">Mature</div>
                      </div>
                  </div>
                  <div class="legend item"
                  data-title="Over-mature tree" 
                  data-content="A Over-mature is classified as old trees which need be cut down recently">
                  <img class="ui avatar image" src="./img/tree_over_mature.svg">
                      <div class="content">
                          <div class="header m-color-white">Over-mature</div>
                      </div>
                  </div>
                </div>
              
              </div>
              <div class="column" style="color:white">
                <h3 style = "text-align: center">Location <i class="question circle legend icon" 
                  data-title="Location" 
                 data-content="This descibes whether a tree is located within a public park or along a street."></i></h3>
              
                <div class="ui middle aligned animated list" style="padding-left: 95px;">
                  <div class="legend item"
                  data-title="Street tree" 
                  data-content="A Street tree is classified as trees planted beside the street">
                    <img class="ui avatar image" src="./img/s.svg">
                    <div class="content">
                      <div class="header m-color-white">Street</div>
                    </div>
                  </div>

                  <div class="legend item"
                  data-title="Park tree" 
                  data-content="A Street tree is classified as trees planted in the park">
                  <img class="ui avatar image" src="./img/p.svg">
                      <div class="content">
                          <div class="header m-color-white">Park</div>
                      </div>
                  </div>
                </div>
              </div>
              <div class="column" style="color:white">
                <h3 style = "text-align: center">Year Planted <i class="question circle legend icon" 
                  data-title="Year Planted" 
                 data-content="This is generally accurate for trees planted from 2003 onwards, prior to 2003 this indicate the date the trees are added to the inventory."></i></h3>
              
              <div class="ui middle aligned animated list" style= "text-align: center">
                  <div class="legend item"
                  data-title="Before 2000 tree" 
                  data-content="A Before 2000 tree is classified as any tree planted before 2000">
                    <img class="ui avatar image" src="./img/year3.svg">
                    <div class="content">
                      <div class="header m-color-white">Before 2000</div>
                    </div>
                  </div>

                 <div class="legend item"
                  data-title="2000 - 2010 tree" 
                  data-content="A 2000 - 2010 tree is classified as any tree planted between 2000 - 2010">
                      <img class="ui avatar image" src="./img/year2.svg">
                      <div class="content">
                        <div class="header m-color-white">2000 - 2010</div>
                      </div>
                  </div>

                  <div class="legend item"
                  data-title="2010 - 2020 tree" 
                  data-content="A 2010 - 2020 tree is classified as any tree planted between 2010 - 2020">
                  <img class="ui avatar image" src="./img/year1.svg">
                      <div class="content">
                          <div class="header m-color-white">2010 - 2020</div>
                      </div>
                  </div>
                </div>
              </div>
              <div class="column" style="color:white">
                <h3 style = "text-align: center">Soil Type <i class="question circle legend icon" 
                  data-title="Soil Type" 
                 data-content="These polygons represent approximate native soil sub-bases and derived textures based on digitized maps from the Geological Survey of Victoria (c. 1956). Soils are expected to be extensively modified from these types throughout Melbourne due to extensive disturbance, and cut and fill associated with the city's development."></i></h3>
              
              <div class="ui middle aligned animated list" style="padding-left: 30px;">
                  <div class="legend item"
                  data-title="Duplex-Clay Silt then Clay" 
                  data-content="Texture in duplex soils is highly variable, with the top-soils ranging from coarse sand to clay loam and the subsoils from light to heavy clay. ">
                    <img class="ui avatar image" src="./img/Duplex-Clay.svg">
                    <div class="content">
                      <div class="header m-color-white">Duplex-Clay Silt then Clay</div>
                    </div>
                  </div>

                  <div class="legend item"
                  data-title="Textured Clay with Sand" 
                  data-content="Textured Clay with Sand">
                    <img class="ui avatar image" src="./img/textured.svg">
                    <div class="content">
                      <div class="header m-color-white">Textured Clay with Sand</div>
                    </div>
                  </div>

                  <div class="legend item"
                  data-title="Stratified Sand/Silt/Clay/Gravel" 
                  data-content="Stratified Sand/Silt/Clay/Gravel">
                    <img class="ui avatar image" src="./img/stratotified.svg">
                    <div class="content">
                      <div class="header m-color-white">Stratified Sand/Silt/Clay/Gravel</div>
                    </div>
                  </div>

                  <div class="legend item"
                  data-title="Silts" 
                  data-content="Silt is granular material of a size between sand and clay, whose mineral origin is quartz and feldspar. ">
                      <img class="ui avatar image" src="./img/silt.svg">
                      <div class="content">
                        <div class="header m-color-white">Silt</div>
                      </div>
                  </div>

                  <div class="legend item"
                  data-title="Juvenile trees" 
                  data-content="In the north west, it's more common to find shallow-dark and reddish-brown heavy clay soils, with a thin loamy topsoil. They benefit from the addition of organic matter. Gypsum can be used to improve soil structure.">
                  <img class="ui avatar image" src="./img/shallow.svg">
                      <div class="content">
                          <div class="header m-color-white">Shallow Heavy Textured Clay</div>
                      </div>
                  </div>

                  <div class="legend item"
                  data-title="Sandy Loam" 
                  data-content="Sandy loam is a type of soil used for gardening. This soil type is normally made up of sand along with varying amounts of silt and clay. Many people prefer sandy loam soil for their gardening because this type of soil normally allows for good drainage.">
                  <img class="ui avatar image" src="./img/sandy.svg">
                      <div class="content">
                          <div class="header m-color-white">Sandy Loam</div>
                      </div>
                  </div>
                </div>
              </div>
            </div>
            

             <!--Why trees are important for Melbourne?-->
            <div id="tree_important_location">
              <br />
              <br />
            </div>
            
            <h2 class="ui olive header">Why trees are important for Melbourne?</h2>
            <hr style="border:1 dashed #987cb9" width="100%" color=#76AD3A SIZE=1>
            <br />
            
            
            <div class="ui grid">
                <div class="eight wide column">
                    <img class="ui large rounded image" src="https://www.melbourne.vic.gov.au/SiteCollectionImages/benefits-of-trees.jpg" alt=”“>
                </div>
                <div class="eight wide column">

                    <br/><br/>
                    <h2 class="sub_title">Benefits of trees:</h2>
                    <h2 class="sub_title">Environmental, human, ecological and economic benefits of trees</h2>
                    
                    <h3 style="color:#989898">
                        Trees provide a wealth of benefits for our environment, our health, and our economy. They provide critical ecosystem services such as air and water filtration, shade, habitat, oxygen, carbon sequestration and nutrient cycling. 
                        <br/><br/>
                        At the city scale, our urban forest helps to adapt our city to climate change, reducing the impact of floods and the urban heat island effect.
                        <br/><br/>
                        Trees also provide amazing health and wellbeing benefits, providing a connection to nature that can sometimes be missing in urban areas.    
                        <br/><br/>
                        
                    </h3>
                    
                    <h3 style="color:#989898"></h3>
                </div>

            
            </div>



        <br />
        <br />
        
          <!--URBAN FOREST ISSUES-->
        <div id="issues_location">
          <br />
          <br />
        </div>
        
        <h2 class="ui olive header" >Urban forest issues</h2>
        <hr style="border:1 dashed #987cb9" width="100%" color=#76AD3A SIZE=1>
        <br/>
        <div class="ui grid">
          <div class="eight wide column">
            <h3 style="font-size:19px; color:white">Why age diversity is important?</h3>
            <h3 style="color:#989898">
              As we know, trees can help us to improve our environment such as cleaning the air and slowing down the climate change. However, a tree will be removed if it's health is not expected to improve. 
              
              <br/><br/>
              There are many trees were planted from more than 100 years ago, they have been playing an very important role in enhancing the quality of environment and our life. While we are benefiting from it, their health is declining as they age.   
              
              It's crucial and in danger if they need to be removed at or around similar time since they were planted around similar time.  
              
             Apart from losing the tree canopy cover and amenity, this can decrease the possible habitat for wildlife.
              <br/><br/>

              Therefore, it's very important to have age diversity with different genus of growth rates and life span.
              <br/><br/>
              
          </h3>
          </div>
          <!-- <p style="font-size:17px; color:#989898">.</p> -->

          <div class="eight wide column">
            <!-- <h2 class="sub_title">Ageing diversity</h2> -->
            <br/><br/><br/><br/>
            <img class="ui large rounded image" src="https://pic51.photophoto.cn/20190524/0017029524190824_b.jpg" alt="">

            
            
            <!-- <h3 style="color:#989898"></h3> -->
          </div>

        </div>
        <br />



        <!--statistic -->
        <div id="statistic_location">
            <br />
            <br />
        </div>
        <h2 class="ui olive header" >Statistic</h2>
        <hr style="border:1 dashed #987cb9" width="100%" color=#76AD3A SIZE=1>
        <h3 style="font-size:17px; color:white">Figures about current trees in Melbourne</h3>
        <p style="font-size:19px; color:#989898">Tree's information including the number of trees are planted each year and whether they are planted in park or street, tree's life expectency, and common genus are shown in the graph below, respectively.</p>

        <br />
        <!--Tableau chart-->
        <div class="ui container">
          
            <div class='tableauPlaceholder' id='viz1604117988869' style='position: relative'><noscript><a href='#'><img alt=' ' src='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;As&#47;Assignment3_16034604091830&#47;Dashboard1&#47;1_rss.png' style='border: none' /></a></noscript><object class='tableauViz'  style='display:none;'><param name='host_url' value='https%3A%2F%2Fpublic.tableau.com%2F' /> <param name='embed_code_version' value='3' /> <param name='site_root' value='' /><param name='name' value='Assignment3_16034604091830&#47;Dashboard1' /><param name='tabs' value='no' /><param name='toolbar' value='yes' /><param name='static_image' value='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;As&#47;Assignment3_16034604091830&#47;Dashboard1&#47;1.png' /> <param name='animate_transition' value='yes' /><param name='display_static_image' value='yes' /><param name='display_spinner' value='yes' /><param name='display_overlay' value='yes' /><param name='display_count' value='yes' /><param name='language' value='en-GB' /><param name='filter' value='publish=yes' /></object></div>
        </div>

        <br />
        <br />
        <br />
        <br />
        <div id="schedule_location">
            <br />
            <br />
        </div>
        <h2 class="ui olive header" >Planting Schedule</h2>
        <hr style="border:1 dashed #987cb9" width="100%" color=#76AD3A SIZE=1>
        <h3 style="font-size:17px; color:white">Future planting schedule</h3>

        <p style="font-size:19px; color:#989898"> The Planting schedule shows when each street will be planted and the instensity of the planting will be. To maximise the use of the map, you can:</p>
        <p style="font-size:19px; color:#989898">- <b>Hover</b> street will show a popup which includes schedule time and street name<br>
        - The area schedule count will dynamically show the number of schedules for the area shown in the maps when you <b>Zoom</b> in or out<br>
        - To filter streets by schedule time, <b>Select</b> the schedule time in the legend<br></p>
        <i class="arrow inverted circle right icon"></i>&nbsp;<a href="https://www.melbourne.vic.gov.au/community/greening-the-city/urban-forest/pages/urban-forest-precinct-plans.aspx">Find out more Precinct Plans</a><br>

        <br />
        <iframe width="100%" height="520" frameborder="0" src="https://lisalisalisa.carto.com/builder/8bdad79b-4d69-4e52-9769-2c4725f562d5/embed" allowfullscreen webkitallowfullscreen mozallowfullscreen oallowfullscreen msallowfullscreen></iframe>
        <p style="font-size:17px; color: #989898"><br>The tree planting map shows the schedule of each street that will be planted. There are streets where tree planting is completed. For the rest, the schedule time information is shown in the popup on hover or can be visualized by color. When prioritising where and when to plant, it is important to spend resources on the streets that are most in need. For example, which street has highest intensity of people where low canopy cover exsits; which streets will gain more by planting trees etc.</p>
       
    </div>
    <br />
    <br />
    <br />
    <br />
    <br />
    <br />

    <script src="./trees.js"></script>
    <!--jquery-->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/semantic-ui@2.4.2/dist/semantic.min.js"></script>

   
    <script th:inline="javascript">
        //tabs
        $('.menu .item')
        .tab()
        ;

        //dropdown
        $('.ui.dropdown').dropdown({
            on : 'hover'
        });

        //popup
        $('#popup')
        .popup({
          
          inline     : true,
          hoverable  : true,
          position   : 'bottom left',
          delay: {
            show: 300,
            hide: 800
          }
        })
      ;
      $('.legend')
        .popup({
            position   : 'right center',
            on    : 'hover'
        })
        ;


        
    </script>
    
    <script type="text/javascript">
        window.onload = function () {
        var menu = ['age', 'location', 'year', 'soil_type'];
        var current_visible_layer = 'age';
        var current_visible_ids = new Set(['New','Juvenile','Semi-mature','Mature','Over-mature']);
        // enumerate ids of the layers
        var age_description = ['New','Juvenile','Semi-mature','Mature','Over-mature'];
        // set up the corresponding toggle button for each layer
        for (var i = 0; i < age_description.length; i++) {
            var id = age_description[i];
            var link = document.createElement('b');
            // link.classList.add("active");
            link.classList.add("item","active_map");
            link.textContent = id;
            link.dataValue = id
            link.id = id
            map.setLayoutProperty(id, 'visibility', 'visible');
            link.onclick = function (e) {
                var clickedLayer = this.textContent;
                e.preventDefault();
                e.stopPropagation();

                var visibility = map.getLayoutProperty(clickedLayer, 'visibility');
                console.log('可见吗？' + visibility)

                // toggle layer visibility by changing the layout object's visibility property
                if (visibility === 'visible') {
                        map.setLayoutProperty(clickedLayer, 'visibility', 'none');
                        this.setAttribute("class","item");
                        console.log('bukejian');
                        current_visible_ids.delete(clickedLayer);
                } else {
                    if (current_visible_layer != 'age'){
                        console.log(current_visible_ids);
                        for (var x of current_visible_ids){
                            var temptag = document.getElementById(x)
                            map.setLayoutProperty(x, 'visibility', 'none');
                            temptag.setAttribute("class","item");
                            console.log('closeothers');
                        }
                        current_visible_ids = new Set([]);
                        current_visible_layer = 'age';
                    }
                    current_visible_ids.add(clickedLayer)
                    this.setAttribute("class","active_map");
                    this.classList.add("item")
                    //this.setAttribute("color","black");
                    map.setLayoutProperty(clickedLayer, 'visibility', 'visible');
                    console.log('kejian')
                }
            };

            var layers = document.getElementById('age');
            layers.appendChild(link);
            //if(i != 0){
            //    map.setLayoutProperty(id, 'visibility', 'none');
            //    link.setAttribute("class","item");
            //    console.log('bukejian')
            //}
        }

        // enumerate ids of the layers
        var locate = ['Location-Street','Location-Park'];
        // set up the corresponding toggle button for each layer
        for (var i = 0; i < locate.length; i++) {
            var id = locate[i];

            var link = document.createElement('b');
            // link.classList.add("active");
            link.classList.add("item","active_map");
            link.textContent = id;
            link.dataValue = id
            link.id = id
            map.setLayoutProperty(id, 'visibility', 'visible');
            link.onclick = function (e) {
                var clickedLayer = this.textContent;
                e.preventDefault();
                e.stopPropagation();

                var visibility = map.getLayoutProperty(clickedLayer, 'visibility');
                console.log('可见吗？' + visibility)

                // toggle layer visibility by changing the layout object's visibility property
                if (visibility === 'visible') {
                        map.setLayoutProperty(clickedLayer, 'visibility', 'none');
                        this.setAttribute("class","item");
                        console.log('bukejian');
                        current_visible_ids.delete(clickedLayer);
                } else {
                    if (current_visible_layer != menu[1]){
                        console.log(current_visible_ids);
                        for (var x of current_visible_ids){
                            var temptag = document.getElementById(x)
                            map.setLayoutProperty(x, 'visibility', 'none');
                            temptag.setAttribute("class","item");
                            console.log('closeothers');
                        }
                        current_visible_ids = new Set([]);
                        current_visible_layer = menu[1];
                    }
                    current_visible_ids.add(clickedLayer)
                    this.setAttribute("class","active_map");
                    this.classList.add("item")
                    //this.setAttribute("color","black");
                    map.setLayoutProperty(clickedLayer, 'visibility', 'visible');
                    console.log('kejian')
                }
            };

            var layers = document.getElementById('location');
            layers.appendChild(link);
            map.setLayoutProperty(id, 'visibility', 'none');
            link.setAttribute("class","item");
            console.log('bukejian')
        }

        // enumerate ids of the layers
        var soil = ['Duplex-Clay Silt then Clay', 'Medium to Heavy Textured Clay with Sand', 'Deep Stratified Sand Silt Clay Gravel',
                    'Silt', 'Shallow Heavy Textured Clay','Sandy Loam'];
        // set up the corresponding toggle button for each layer
        for (var i = 0; i < soil.length; i++) {
            var id = soil[i];

            var link = document.createElement('c');
            // link.classList.add("active");
            link.classList.add("item","active_map");
            link.textContent = id;
            link.dataValue = id
            link.id = id
            map.setLayoutProperty(id, 'visibility', 'visible');
            
            link.onclick = function (e) {
                var clickedLayer = this.textContent;
                e.preventDefault();
                e.stopPropagation();

                var visibility = map.getLayoutProperty(clickedLayer, 'visibility');
                console.log('可见吗？' + visibility)

                // toggle layer visibility by changing the layout object's visibility property
                if (visibility === 'visible') {
                        map.setLayoutProperty(clickedLayer, 'visibility', 'none');
                        this.setAttribute("class","item");
                        console.log('bukejian');
                        current_visible_ids.delete(clickedLayer);
                } else {
                    if (current_visible_layer != menu[3]){
                         console.log(current_visible_ids);
                        for (var x of current_visible_ids){
                            var temptag = document.getElementById(x)
                            map.setLayoutProperty(x, 'visibility', 'none');
                            temptag.setAttribute("class","item");
                            console.log('closeothers');
                        }
                        current_visible_ids = new Set([]);
                        current_visible_layer = menu[3];
                    }
                    current_visible_ids.add(clickedLayer)
                    this.setAttribute("class","active_map");
                    this.classList.add("item")
                    //this.setAttribute("color","black");
                    map.setLayoutProperty(clickedLayer, 'visibility', 'visible');
                    console.log('kejian')
                }
        };
 
            map.setLayoutProperty(id, 'visibility', 'none');
            link.setAttribute("class","item");
            console.log('bukejian')
            var layers = document.getElementById('soil_type');
            layers.appendChild(link);
        }

        

        // enumerate ids of the layers
        var year = ['Before 2000', '2000-2010', '2010-2020'];
        // set up the corresponding toggle button for each layer
        for (var i = 0; i < year.length; i++) {
            var id = year[i];

            var link = document.createElement('c');
            // link.classList.add("active");
            link.classList.add("item","active_map");
            link.textContent = id;
            link.dataValue = id
            link.id = id
            map.setLayoutProperty(id, 'visibility', 'visible');
            link.onclick = function (e) {
                var clickedLayer = this.textContent;
                e.preventDefault();
                e.stopPropagation();

                var visibility = map.getLayoutProperty(clickedLayer, 'visibility');
                console.log('可见吗？' + visibility)

                // toggle layer visibility by changing the layout object's visibility property
                if (visibility === 'visible') {
                        map.setLayoutProperty(clickedLayer, 'visibility', 'none');
                        this.setAttribute("class","item");
                        console.log('bukejian');
                        current_visible_ids.delete(clickedLayer);
                } else {
                console.log('current_visible_layer');
                    
                    if (current_visible_layer != menu[2]){
                        console.log(current_visible_ids);
                        for (var x of current_visible_ids){
                            var temptag = document.getElementById(x)
                            map.setLayoutProperty(x, 'visibility', 'none');
                            temptag.setAttribute("class","item");
                            console.log('closeothers');
                        }
                        current_visible_ids = new Set([]);
                        current_visible_layer = menu[2];
                    }
                    current_visible_ids.add(clickedLayer)
                    this.setAttribute("class","active_map");
                    this.classList.add("item")
                    //this.setAttribute("color","black");
                    map.setLayoutProperty(clickedLayer, 'visibility', 'visible');
                    console.log('kejian')
                }
            };

            map.setLayoutProperty(id, 'visibility', 'none');
            link.setAttribute("class","item");
            console.log('bukejian')
            var layers = document.getElementById('year');
            layers.appendChild(link);
        }

        for (var i = 0; i < menu.length; i++) {
            var layers = document.getElementById(menu[i]);
            var link = document.createElement('b');
            layers.appendChild(link);
        }
    }

    </script>  
    
   
</body>
</html>